<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Ï„Î·Î½ ÎµÏÏ‰Ï„Î¹ÎºÎ® Î¼Î±Ï‚ Î¹ÏƒÏ„Î¿ÏÎ¯Î±â¤ï¸</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    overflow: hidden;
    background: linear-gradient(to bottom, #ffd1dc, #fff0f5);
    font-family: Arial, sans-serif;
}

canvas {
    display: block;
}

#score {
    position: absolute;
    top: 10px;
    left: 10px;
    font-size: 18px;
    color: #d6336c;
}

#overlay {
    position: absolute;
    inset: 0;
    background: rgba(255,255,255,0.95);
    display: none;
    flex-direction: column;
    justify-content: center;
    align-items: center;
    text-align: center;
    padding: 20px;
}

#overlay img {
    max-width: 80%;
    max-height: 250px;
    border-radius: 10px;
    margin: 15px 0;
}

button {
    padding: 10px 20px;
    font-size: 18px;
    background: #d6336c;
    color: white;
    border: none;
    border-radius: 8px;
    cursor: pointer;
}

#controls {
    position: absolute;
    bottom: 20px;
    width: 100%;
    display: flex;
    justify-content: space-between;
    padding: 0 20px;
    box-sizing: border-box;
}

#finalVideo {
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    width: 90%;
    height: auto;
    max-height: 90%;
    border-radius: 10px;
    z-index: 1000;
}

.control-btn {
    width: 70px;
    height: 70px;
    background: rgba(214,51,108,0.8);
    color: white;
    font-size: 30px;
    border-radius: 50%;
    display: flex;
    justify-content: center;
    align-items: center;
    user-select: none;
}
.confetti {
    position: absolute;
    width: 12px;
    height: 12px;
    pointer-events: none;
    opacity: 1;
    font-size: 18px;
    animation: fall linear forwards;
}

@keyframes fall {
    to {
        transform: translate(var(--x), var(--y)) rotate(var(--r));
        opacity: 0;
    }
}
</style>
</head>
<body>

<div id="score">Hearts: 0</div>

<div id="overlay">
    <h2 id="message"></h2>
    <img id="photo" style="display:none;">
    <audio id="voice" controls style="display:none;"></audio>
    <button onclick="nextLevel()">Continue â¤ï¸</button>
    <button id="reclaimBtn" style="display:none;" onclick="showFinalVideo()">Reclaim your prize ğŸ</button>

</div>

<video id="finalVideo" width="80%" style="display:none; border-radius:10px;" controls></video>

<canvas id="game"></canvas>

<div id="controls">
    <div class="control-btn" id="leftBtn">â—€</div>
    <div class="control-btn" id="rightBtn">â–¶</div>
</div>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

canvas.width = window.innerWidth;
canvas.height = window.innerHeight;

let basket = {
    x: canvas.width / 2 - 40,
    y: canvas.height - 80,
    width: 80,
    height: 20,
    speed: 7
};

let hearts = [];
let score = 0;
let level = 0;
let gameActive = true;

const levels = [
    {
        target: 2,
        message: "From our early days â¤ï¸",
        photo: "photo1.jpg"
    },
    {
        target: 5,
        message: "Through our playful times â¤ï¸",
        photo: "photo2.jpg"
    },
    {
        target: 8,
        message: "Every day with you is special ğŸ’•",
        photo: "photo3.jpg"
    },
    {
        target: 12,
        message: "Happy Valentineâ€™s Day, Î· Î³Ï…Î½Î±Î¯ÎºÎ± Î¼Î¿Ï…!! â¤ï¸ ÏƒÎµ Î±Î³Î±Ï€Ï!",
        photo: "photo4.jpg"
    }
];

// Controls
let left = false;
let right = false;

document.addEventListener("keydown", e => {
    if (e.key === "ArrowLeft") left = true;
    if (e.key === "ArrowRight") right = true;
});

document.addEventListener("keyup", e => {
    if (e.key === "ArrowLeft") left = false;
    if (e.key === "ArrowRight") right = false;
});

// Mobile controls
document.getElementById("leftBtn").ontouchstart = () => left = true;
document.getElementById("leftBtn").ontouchend = () => left = false;
document.getElementById("rightBtn").ontouchstart = () => right = true;
document.getElementById("rightBtn").ontouchend = () => right = false;

// Spawn hearts
function spawnHeart() {
    if (!gameActive) return;
    hearts.push({
        x: Math.random() * (canvas.width - 30),
        y: -30,
        size: 30,
        speed: 2 + Math.random() * 2
    });
}
setInterval(spawnHeart, 800);

function drawHeart(x, y, size) {
    ctx.font = size + "px Arial";
    ctx.fillText("â¤ï¸", x, y);
}

function showOverlay(data) {
    gameActive = false;
    document.getElementById("overlay").style.display = "flex";
    document.getElementById("message").textContent = data.message;

    const photo = document.getElementById("photo");
    const voice = document.getElementById("voice");

    photo.style.display = "none";
    voice.style.display = "none";

    if (data.photo) {
        photo.src = data.photo;
        photo.style.display = "block";
    }

    if (data.voice) {
        voice.src = data.voice;
        voice.style.display = "block";
    }
}

function nextLevel() {
    document.getElementById("overlay").style.display = "none";
    level++;
    score = 0;
    hearts = [];

    if (level >= levels.length) {
        // Show final message
        const overlay = document.getElementById("overlay");
        const message = document.getElementById("message");
        const button = overlay.querySelector("button");
        const reclaimBtn = document.getElementById("reclaimBtn");

        message.textContent = "Forever your malaka â¤ï¸";
        document.getElementById("photo").style.display = "none";

        // Hide the continue button
        button.style.display = "none";

        celebrate();

        overlay.style.display = "flex";

        reclaimBtn.style.display = "inline-block";

        return;
    }

    gameActive = true;
}

function update() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    if (left) basket.x -= basket.speed;
    if (right) basket.x += basket.speed;

    basket.x = Math.max(0, Math.min(canvas.width - basket.width, basket.x));

    ctx.fillStyle = "#d6336c";
    ctx.fillRect(basket.x, basket.y, basket.width, basket.height);

    hearts.forEach((heart, index) => {
        heart.y += heart.speed;
        drawHeart(heart.x, heart.y, heart.size);

        if (
            heart.y + heart.size > basket.y &&
            heart.x < basket.x + basket.width &&
            heart.x + heart.size > basket.x
        ) {
            hearts.splice(index, 1);
            score++;
            document.getElementById("score").textContent = "Hearts: " + score;

            if (score >= levels[level].target) {
                showOverlay(levels[level]);
            }
        }

        if (heart.y > canvas.height) {
            hearts.splice(index, 1);
        }
    });

    requestAnimationFrame(update);
}

update();

function showFinalVideo() {
    const reclaimBtn = document.getElementById("reclaimBtn");
    const video = document.getElementById("finalVideo");
    const overlay = document.getElementById("overlay");

    reclaimBtn.style.display = "none";
    overlay.style.display = "none";

    video.src = "ophelia.mp4"; // your video file
    video.style.display = "block";
    video.play();
}

function celebrate() {
    const colors = ["#d6336c", "#ff69b4", "#ff1493", "#ffb6c1", "#ffc0cb"];
    const symbols = ["â¤ï¸", "ğŸ’–", "ğŸ’˜", "ğŸ’", "ğŸ’"];
    
    for (let i = 0; i < 100; i++) {
        const confetti = document.createElement("div");
        confetti.className = "confetti";
        confetti.innerHTML = symbols[Math.floor(Math.random() * symbols.length)];
        confetti.style.color = colors[Math.floor(Math.random() * colors.length)];
        confetti.style.left = Math.random() * window.innerWidth + "px";
        confetti.style.top = "-20px";
        confetti.style.setProperty("--x", (Math.random() * 200 - 100) + "px");
        confetti.style.setProperty("--y", window.innerHeight + "px");
        confetti.style.setProperty("--r", (Math.random() * 360) + "deg");
        confetti.style.animationDuration = (3 + Math.random() * 2) + "s";
        document.body.appendChild(confetti);
        setTimeout(() => confetti.remove(), 5000);
    }
}

</script>
</body>
</html>
